## TCP/IP 通讯

### 上行包头

6字节或4字节

完整包头：

| ADDRESS | NAME  |                       NOTE                        |
| :-----: | :---: | :-----------------------------------------------: |
|  0x00   | HEAD1 |           包头的第一标志位 默认值为0x55           |
|  0x01   | HEAD2 |           包头的第二标志位 默认值为0xAA           |
|  0x02   | TYPE  | 前三位表示每通道数据所用的位数 后五位表示数据类型 |
|  0x03   | CHNUM |             表示通道数 数据为通道数-1             |
|  0x04   | PART  |                      校验位                       |

简单包头：

包头备注：

| No.  |     NAME      |    NOTE    |  x   |
| :--: | :-----------: | :--------: | :--: |
|  1   | HEAD1 [7 : 0] |    0x55    |      |
|  2   | HEAD2 [7 : 0] |    0xAA    |      |
|  3   | TYPE [7 : 5]  | 公式 补充1 | 位数 |
|  4   | TYPE [4 : 0]  | 表格 补充1 |      |
|  5   | CHNUM [7 : 0] | 公式 补充2 | 个数 |

补充公式：
$$
f(x) = \frac{x}{4} - 1
$$

$$
f(x) = x - 1
$$


$$
f(x) = (TYPE + CHNUM + FRTI + FRBA) \% 256
$$

补充表格：

| No.  |  NAME   |       0        |       1        | DEFAULT |
| :--: | :-----: | :------------: | :------------: | :-----: |
|  1   | TYPE[4] |  错误上行数据  |  正常上行数据  |    1    |
|  2   | TYPE[3] | 下位机运行错误 | 下位机运行正常 |    1    |
|  3   | TYPE[2] |    上行数据    |    上行状态    |    0    |
|  4   | TYPE[1] |     自定义     |     自定义     |    1    |
|  5   | TYPE[0] |     自定义     |     自定义     |    0    |

### 下行包头

完整包头：

| ADDRESS | NAMEk |             NOTE              |
| :-----: | :---: | :---------------------------: |
|  0x00   | HEAD1 | 包头的第一标志位 默认值为0x5A |
|  0x01   | HEAD2 | 包头的第二标志位 默认值为0xA5 |
|  0x02   | TYPE  |         表示数据类型          |
|  0x03   | CMNUM |           命令数量            |
|  0x04   |  COM  |          自定义类型           |
|  0x05   | PART  |            校验位             |

包头备注：

| No.  |     NAME      |     NOTE      |  x   |
| :--: | :-----------: | :-----------: | :--: |
|  1   | HEAD1 [7 : 0] |     0x5A      |      |
|  2   | HEAD2 [7 : 0] |     0xA5      |      |
|  3   | TYPE [7 : 6]  |  表格 补充 2  |      |
|  4   |  TYPE[5 : 4]  |  表格 补充3   |      |
|  5   | TYPE [3 : 0]  |  公式 补充 4  | 位数 |
|  6   | CMNUM [7 : 0] |  公式 补充 5  | 个数 |
|  7   |  COM [7 : 0]  |    自定义     |  0   |
|  8   | PART [7 : 0]  | 校验位 补充 6 |      |

补充公式：
$$
f(x) = \frac{x}{4} - 1
$$

$$
f(x) = x - 1
$$

$$
f(x) = (TYPE + CMNUM + COM) \% 256
$$

补充表格：

| No.  |   NAME    |         0          |        1         | DEFAULT |
| :--: | :-------: | :----------------: | :--------------: | :-----: |
|  1   |  TYPE[7]  | 此下行包不是中止包 | 此下行包是中止包 |    1    |
|  2   |  TYPE[6]  |   此下行包是数据   |  此下行包是命令  |    1    |
|  3   | TYPE[5:4] |                    |                  |    1    |

| No.  | NUM  |  TYPE  |
| :--: | :--: | :----: |
|  1   |  00  |  void  |
|  2   |  01  |  char  |
|  3   |  10  |  int   |
|  4   |  11  | double |

COM命令设置：

| No.  | COMMAND | FUNCTION DESCRIPTION | BYTES |
| :--: | :-----: | :------------------: | :---: |
|  1   |  0x80   |        通道数        |   1   |
|  2   |  0x81   | 倍数 * 基础采样频率  |   2   |
|  3   |  0x00   |       默认命令       |       |

COM数据设置：

| No.  | COMMAND | FUNCTION DESCRIPTION |
| :--: | :-----: | :------------------: |
|  1   |  0x00   |      滤波器1的a      |
|  2   |  0x01   |      滤波器1的b      |
|  1   |  0x02   |      滤波器2的a      |
|  1   |  0x03   |      滤波器2的b      |
|  1   |  0x04   |      滤波器3的a      |
|  2   |  0x05   |      滤波器3的b      |
|  1   |  0x06   |      滤波器4的a      |
|  1   |  0x07   |      滤波器4的b      |
|  1   |  0x08   |      滤波器5的a      |
|  2   |  0x09   |      滤波器5的b      |
|  1   |  0x0A   |      滤波器6的a      |
|  1   |  0x0B   |      滤波器6的b      |
|  1   |  0x0C   |      滤波器7的a      |
|  2   |  0x0D   |      滤波器7的b      |
|  1   |  0x0E   |      滤波器8的a      |
|  1   |  0x0F   |      滤波器8的b      |
|  1   |  0x10   |      滤波器9的a      |
|  2   |  0x11   |      滤波器9的b      |
|  1   |  0x12   |     滤波器10的a      |
|  1   |  0x13   |     滤波器10的b      |
|  1   |  0x14   |     滤波器11的a      |
|  2   |  0x15   |     滤波器11的b      |
|  1   |  0x16   |     滤波器12的a      |
|  1   |  0x17   |     滤波器12的b      |
|  1   |  0x18   |     滤波器13的a      |
|  2   |  0x19   |     滤波器13的b      |
|  1   |  0x1A   |     滤波器14的a      |
|  1   |  0x1B   |     滤波器14的b      |
|  1   |  0x1C   |     滤波器15的a      |
|  2   |  0x1D   |     滤波器15的b      |
|  1   |  0x1E   |     滤波器16的a      |
|  1   |  0x1F   |     滤波器16的a      |